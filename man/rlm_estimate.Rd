% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_aggregation.R
\name{rlm_estimate}
\alias{rlm_estimate}
\title{Estimate e.g. protein abundance from peptides using MASS:rlm}
\usage{
rlm_estimate(pdata, expression, feature, samples, maxIt = 20)
}
\arguments{
\item{pdata}{data}

\item{expression}{intensities}

\item{feature}{e.g. peptideIDs.}

\item{sample}{e.g. sampleName}
}
\description{
Estimate e.g. protein abundance from peptides using MASS:rlm
}
\examples{

xx <- data.frame(expression = rnorm(20,0,10), feature = rep(LETTERS[1:5],4), samples= rep(letters[1:4],5))

bb <- rlm_estimate(xx , "expression", "feature", "samples", maxIt = 20)
bb

xx2 <- data.frame(log2Area = rnorm(20,0,10), peptide_Id = rep(LETTERS[1:5],4), sampleName = rep(letters[1:4],5))
rlm_estimate(xx2, "log2Area", "peptide_Id", "sampleName")
rlm_estimate(prolfqua_data('data_checksummarizationrobust87'),"log2Area", "peptide_Id", "sampleName")
rlm_estimate(prolfqua_data('data_checksummarizerobust69'),"log2Area", "peptide_Id", "sampleName")
res <- vector(100,mode = "list")
for (i in seq_len(100)) {
  xx3 <- xx2
  xx3$log2Area[sample(1:20,sample(1:15,1))] <- NA
  res[[i]] <- list(data = xx3, summary = rlm_estimate(xx3, "log2Area", "peptide_Id", "sampleName"))
}
rlm_estimate(xx2[xx2$peptide_Id == 'A',],"log2Area", "peptide_Id", "sampleName")
rlm_estimate(xx2[xx2$sampleName == 'a',],"log2Area", "peptide_Id", "sampleName")


bb <- old2new(prolfqua_data('data_ionstar')$filtered())
stopifnot(nrow(bb$data) == 25780)
conf <- bb$config
data <- bb$data
conf$table$hierarchyDepth = 1
xnested <- data |>
  dplyr::group_by_at(conf$table$hkeysDepth()) |> tidyr::nest()

feature <- setdiff(conf$table$hierarchyKeys(),  conf$table$hkeysDepth())
x <- xnested$data[[1]]
bb <- rlm_estimate(x,
 expression = conf$table$get_work_intensity(),
  feature = feature,
   samples = conf$table$sampleName)

prolfqua:::.reestablish_condition(x,bb, conf)

}
\seealso{
Other aggregation: 
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{aggregate_intensity_topN}()},
\code{\link{estimate_intensity}()},
\code{\link{intensity_summary_by_hkeys}()},
\code{\link{medpolish_estimate_dfconfig}()},
\code{\link{medpolish_estimate_df}()},
\code{\link{medpolish_estimate}()},
\code{\link{medpolish_protein_estimates}()},
\code{\link{plot_estimate}()},
\code{\link{plot_hierarchies_add_quantline}()},
\code{\link{plot_hierarchies_line_df}()},
\code{\link{plot_hierarchies_line}()},
\code{\link{rlm_estimate_dfconfig}()}
}
\concept{aggregation}
\keyword{internal}
