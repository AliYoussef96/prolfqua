% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_MQ_workflow.R
\name{make2grpReport}
\alias{make2grpReport}
\alias{write_2GRP}
\alias{render_2GRP}
\title{Create 2 grp report in html and write data to xlsx table}
\usage{
make2grpReport(
  startdata,
  atable,
  GRP2,
  protein_annot = "Description",
  revpattern = "^REV_",
  contpattern = "^zz|^CON__",
  remove = FALSE,
  transform = c("robscale", "vsn", "none"),
  aggregate = c("medpolish", "topN", "lmrob")
)

write_2GRP(GRP2, outpath, xlsxname = "AnalysisResults")

render_2GRP(GRP2, outpath, htmlname = "Result2Grp", word = FALSE)
}
\arguments{
\item{startdata}{table in long format}

\item{atable}{AnalysisTableAnnotation annotate startdata table}

\item{GRP2}{return value of \code{\link{make2grpReport}}}

\item{protein_annot}{column with portein desciription e.g. (fasta header)}

\item{revpattern}{default "REV_"}

\item{contpattern}{default "^zz|^CON__"}

\item{remove}{do you want to remove contaminants default (TRUE)}

\item{transform}{which transformation to use to normalize the data, default robscale}

\item{outpath}{path to place output}

\item{xlsxname}{file name for xlsx}

\item{htmlname}{name for html file}
}
\description{
For use examples see run_scripts directory
}
\examples{

istar <- prolfqua_data('data_ionstar')$filtered()
data <- istar$data |> dplyr::filter(protein_Id \%in\% sample(protein_Id, 100))
data$Description <-"AAAAA"

GRP2 <- list()
GRP2$Bfabric <- list()
GRP2$Bfabric$projectID <- "3765"
GRP2$Bfabric$projectName <- "Order_26863"
GRP2$Bfabric$orderID <- "3765"

GRP2$Bfabric$workunitID <- "2057368.zip"
GRP2$Bfabric$inputID <- "2057368.zip"
GRP2$Bfabric$inputURL <- "https://www.fgcz.ch"

#at least 2 peptides per protein
GRP2$nrPeptides <- 2
GRP2$transform <- "robscale"
GRP2$transform <- "vsn"
GRP2$aggregate <- "medpolish"
GRP2$Software <- "MaxQuant"
# Set FC to >= |2| and FRD to 0.1
GRP2$Diffthreshold <- 0.5
GRP2$FDRthreshold <- 0.25
GRP2$Contrasts <- c(b_vs_a = "dilution.b - dilution.a")

data <- dplyr::filter(data, dilution. == "a" |  dilution. == "b")

 atab <- AnalysisTableAnnotation$new()

atab$fileName = "raw.file"
atab$hierarchy["protein_Id"] = "protein_Id"
atab$hierarchy["peptide_Id"] = "peptide_Id"

atab$factors["dilution."] = "dilution."
atab$setWorkIntensity("peptide.intensity")
atab$isotopeLabel = "isotope"
config <- prolfqua::AnalysisConfiguration$new(atab)

protein_annot = "Description"
undebug(make2grpReport)
grp <- make2grpReport(data,atab, GRP2, NULL,
 transform = GRP2$transform,
 aggregate = GRP2$aggregate)
#\dontrun{

render_2GRP(grp, ".")
render_2GRP(grp, "." ,word = TRUE)
write_2GRP(grp,".")
#}

}
\concept{workflow}
