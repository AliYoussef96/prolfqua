% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_R6_Modelling.R
\name{moderated_p_limma_long}
\alias{moderated_p_limma_long}
\title{Moderate p-value for long table}
\usage{
moderated_p_limma_long(mm, group_by_col = "lhs")
}
\arguments{
\item{mm}{result of `contrasts_linfct``}

\item{group_by_col}{colnames with contrast description - default 'lhs'}
}
\description{
Moderate p-value for long table
}
\examples{
library(LFQService)
modelSummary_A <- LFQService::modelSummary_A
m <- get_complete_model_fit(modelSummary_A$modelProteinF)
factor_contrasts <- linfct_factors_contrasts(m)
factor_levelContrasts <- contrasts_linfct( modelSummary_A$modelProteinF,
                                                   modelSummary_A$modelName,
                                                   factor_contrasts,
                                                   subject_Id = "Compound")

mmm <- moderated_p_limma_long(factor_levelContrasts, group_by_col = "lhs")
plot(mmm$p.value, mmm$moderated.p.value, log="xy")
abline(0,1, col=2)

# updating lmer model
models_interaction <- LFQService::models_interaction

m <- get_complete_model_fit(models_interaction$modelProtein)
factor_contrasts <- linfct_factors_contrasts(m$lmer_f_Condition_r_peptid_r_patient[[1]])
factor_levelContrasts <- contrasts_linfct(m,
                                         models_interaction$modelName,
                                         factor_contrasts,
                                         subject_Id = "protein_Id")

mmm <- moderated_p_limma_long(factor_levelContrasts, group_by_col = "lhs")
head(mmm)
plot(mmm$p.value, mmm$moderated.p.value, log="xy")
abline(0,1, col=2)

}
