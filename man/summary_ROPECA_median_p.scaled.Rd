% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_R6_Modelling.R
\name{summary_ROPECA_median_p.scaled}
\alias{summary_ROPECA_median_p.scaled}
\title{compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value}
\usage{
summary_ROPECA_median_p.scaled(
  contrasts_data,
  contrast = "lhs",
  subject_Id = "protein_Id",
  estimate = "estimate",
  statistic = "statistic",
  p.value = "moderated.p.value",
  max.n = 10
)
}
\arguments{
\item{max.n}{used to limit the number of peptides in probablity computation.}
}
\description{
compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value
}
\examples{

library(LFQService)
nrPep <- 10000
nrProtein <- 800
p.value <- runif(nrPep)
estimate <- sample(c(-1,1),nrPep, replace = TRUE)
protein_Id <- sample(1:800, size = nrPep,
  replace = TRUE, prob = dexp(seq(0,5,length = 800)))

plot(table(table(protein_Id)))

testdata <- data.frame(lhs = "contrast1", protein_Id = protein_Id,
  estimate = estimate, pseudo_estimate = estimate, p.value = p.value )
  head(testdata)
xx <- summary_ROPECA_median_p.scaled(testdata,

                                    subject_Id = "protein_Id",
                                    estimate = "estimate",
                                    p.value = "p.value",
                                    max.n = 10)
colnames(xx)
hist(testdata$p.value)
hist(xx$median.p.scaled, breaks = 20)
hist(xx$median.p, breaks = 20)
hist(xx$beta.based.significance, breaks = 20)


summary_ROPECA_median_p.scaled(LFQService::exampleDataForRopeca, contrast = "contrast")
}
