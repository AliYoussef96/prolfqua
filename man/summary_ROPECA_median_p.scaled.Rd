% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/tidyMS_R6_Modelling.R
\name{summary_ROPECA_median_p.scaled}
\alias{summary_ROPECA_median_p.scaled}
\title{compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value}
\usage{
summary_ROPECA_median_p.scaled(
  contrasts_data,
  contrast = "contrast",
  subject_Id = "protein_Id",
  estimate = "estimate",
  statistic = "statistic",
  p.value = "moderated.p.value",
  max.n = 10
)
}
\arguments{
\item{max.n}{used to limit the number of peptides in probablity computation.}
}
\value{
data.frame with columns
}
\description{
compute protein level fold changes and p.values (using beta distribution)
takes p-value of the scaled p-value
}
\examples{

library(prolfqua)
library(tidyverse)
nrPep <- 10000
nrProtein <- 800
p.value <- runif(nrPep)
estimate <- runif(nrPep)
protein_Id <- sample(1:800, size = nrPep,
  replace = TRUE, prob = dexp(seq(0,5,length = 800)))

plot(table(table(protein_Id)))

testdata <- data.frame(contrast = "contrast1", protein_Id = protein_Id,
  estimate = estimate, pseudo_estimate = estimate, p.value = p.value )
  head(testdata)
xx30 <- summary_ROPECA_median_p.scaled(testdata,
                                    subject_Id = "protein_Id",
                                    estimate = "estimate",
                                    p.value = "p.value",
                                    max.n = 30)
xx30$mad.estimate
xx2 <- summary_ROPECA_median_p.scaled(testdata,

                                    subject_Id = "protein_Id",
                                    estimate = "estimate",
                                    p.value = "p.value",
                                    max.n = 1)
mad(xx2$estimate, na.rm=TRUE)

hist(testdata$p.value)
hist(xx30$median.p.scaled, breaks = 20)
hist(xx2$median.p.scaled, breaks = 20)
hist(xx30$beta.based.significance, breaks = 20)
hist(xx2$beta.based.significance, breaks = 20)
hist(xx2$median.p.value, breaks = 20)
hist(xx2$beta.based.significance, breaks = 20)
hist(xx2$mad.estimate)

summary_ROPECA_median_p.scaled(prolfqua::exampleDataForRopeca, contrast = "contrast")
xx2$mad.estimate


}
\seealso{
Other modelling: 
\code{\link{ContrastsModerated}},
\code{\link{ContrastsROPECA}},
\code{\link{ContrastsSimpleImpute}},
\code{\link{Contrasts_Plotter}},
\code{\link{Contrasts}},
\code{\link{INTERNAL_FUNCTIONS_BY_FAMILY}},
\code{\link{LR_test}()},
\code{\link{Model}},
\code{\link{build_model}()},
\code{\link{get_complete_model_fit}()},
\code{\link{get_imputed_contrasts}()},
\code{\link{get_model_coefficients}()},
\code{\link{get_p_values_pbeta}()},
\code{\link{isSingular_lm}()},
\code{\link{linfct_all_possible_contrasts}()},
\code{\link{linfct_factors_contrasts}()},
\code{\link{linfct_from_model}()},
\code{\link{linfct_matrix_contrasts}()},
\code{\link{model_analyse}()},
\code{\link{moderated_p_limma_long}()},
\code{\link{moderated_p_limma}()},
\code{\link{ms_brms_model}()},
\code{\link{ms_mcmc_checkzero}()},
\code{\link{ms_mcmc_constrast}()},
\code{\link{my_contest}()},
\code{\link{my_contrast_V1}()},
\code{\link{my_contrast_V2}()},
\code{\link{my_contrast}()},
\code{\link{my_glht}()},
\code{\link{pivot_model_contrasts_2_Wide}()},
\code{\link{plot_lmer_model_and_data_TWO}()},
\code{\link{plot_lmer_model_and_data}()},
\code{\link{plot_lmer_peptide_noRandom_TWO}()},
\code{\link{plot_lmer_peptide_noRandom}()},
\code{\link{plot_lmer_peptide_predictions}()},
\code{\link{plot_lmer_predicted_interactions}()},
\code{\link{strategy_glm}()},
\code{\link{strategy_lmer}()},
\code{\link{strategy_lm}()}
}
\concept{modelling}
\keyword{internal}
